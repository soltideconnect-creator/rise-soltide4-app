<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Paystack Payment Test - Rise Premium</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-center;
      padding: 20px;
    }

    .container {
      background: white;
      border-radius: 20px;
      padding: 40px;
      max-width: 500px;
      width: 100%;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    h1 {
      color: #333;
      margin-bottom: 10px;
      font-size: 28px;
    }

    .subtitle {
      color: #666;
      margin-bottom: 30px;
      font-size: 14px;
    }

    .info-box {
      background: #f8f9fa;
      border-left: 4px solid #667eea;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 8px;
    }

    .info-box h3 {
      color: #333;
      font-size: 14px;
      margin-bottom: 8px;
    }

    .info-box p {
      color: #666;
      font-size: 13px;
      line-height: 1.6;
    }

    .form-group {
      margin-bottom: 20px;
    }

    label {
      display: block;
      color: #333;
      font-weight: 600;
      margin-bottom: 8px;
      font-size: 14px;
    }

    input {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 14px;
      transition: border-color 0.3s;
    }

    input:focus {
      outline: none;
      border-color: #667eea;
    }

    .btn {
      width: 100%;
      padding: 14px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
    }

    .btn:active {
      transform: translateY(0);
    }

    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    .status {
      margin-top: 20px;
      padding: 15px;
      border-radius: 8px;
      font-size: 14px;
      display: none;
    }

    .status.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
      display: block;
    }

    .status.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
      display: block;
    }

    .status.info {
      background: #d1ecf1;
      color: #0c5460;
      border: 1px solid #bee5eb;
      display: block;
    }

    .test-card {
      background: #fff3cd;
      border: 1px solid #ffc107;
      border-radius: 8px;
      padding: 15px;
      margin-top: 20px;
    }

    .test-card h4 {
      color: #856404;
      font-size: 14px;
      margin-bottom: 10px;
    }

    .test-card code {
      display: block;
      background: white;
      padding: 8px;
      border-radius: 4px;
      margin: 5px 0;
      font-size: 12px;
      color: #333;
    }

    .footer {
      margin-top: 30px;
      text-align: center;
      color: #999;
      font-size: 12px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üöÄ Paystack Payment Test</h1>
    <p class="subtitle">Test Rise Premium payment integration</p>

    <div class="info-box">
      <h3>üìã Test Information</h3>
      <p>
        <strong>Product:</strong> Rise Premium Unlock<br>
        <strong>Amount:</strong> ‚Ç¶8,000 (800,000 kobo)<br>
        <strong>Payment Methods:</strong> Card, Bank, USSD, Mobile Money
      </p>
    </div>

    <form id="paymentForm">
      <div class="form-group">
        <label for="email">Email Address</label>
        <input 
          type="email" 
          id="email" 
          placeholder="your.email@example.com" 
          required
          value="test@example.com"
        >
      </div>

      <button type="submit" class="btn" id="payButton">
        ‚ö° Pay ‚Ç¶8,000 with Paystack
      </button>
    </form>

    <div id="status" class="status"></div>

    <div class="test-card">
      <h4>üß™ Test Card Details</h4>
      <code>Card: 4084 0840 8408 4081</code>
      <code>Expiry: 12/25</code>
      <code>CVV: 408</code>
      <code>PIN: 0000</code>
      <code>OTP: 123456</code>
    </div>

    <div class="footer">
      <p>Powered by Paystack ‚Ä¢ Secure Payment Gateway</p>
    </div>
  </div>

  <!-- Load Paystack Inline JS -->
  <script src="https://js.paystack.co/v1/inline.js"></script>

  <script>
    const form = document.getElementById('paymentForm');
    const emailInput = document.getElementById('email');
    const payButton = document.getElementById('payButton');
    const statusDiv = document.getElementById('status');

    // Public key
    const publicKey = 'pk_live_000ac40050b8af5c5ee87edb8976d88d6eb6e315';

    // Generate unique reference
    function generateReference() {
      const timestamp = Date.now();
      const random = Math.floor(Math.random() * 1000000);
      return `RISE_${timestamp}_${random}`;
    }

    // Show status message
    function showStatus(message, type) {
      statusDiv.textContent = message;
      statusDiv.className = `status ${type}`;
      statusDiv.style.display = 'block';
    }

    // Handle form submission
    form.addEventListener('submit', function(e) {
      e.preventDefault();

      const email = emailInput.value.trim();

      if (!email || !email.includes('@')) {
        showStatus('‚ùå Please enter a valid email address', 'error');
        return;
      }

      // Disable button
      payButton.disabled = true;
      payButton.textContent = '‚è≥ Opening Payment...';
      showStatus('üîÑ Initializing payment...', 'info');

      try {
        // Generate unique reference
        const reference = generateReference();

        console.log('üöÄ Starting Paystack payment:', {
          reference,
          email,
          amount: '‚Ç¶8,000',
          timestamp: new Date().toISOString()
        });

        // Initialize Paystack payment
        const handler = PaystackPop.setup({
          key: publicKey,
          email: email,
          amount: 800000, // ‚Ç¶8,000 in kobo
          currency: 'NGN',
          ref: reference,
          channels: ['card', 'bank', 'ussd', 'mobile_money'],
          metadata: {
            custom_fields: [
              {
                display_name: 'Product',
                variable_name: 'product',
                value: 'Rise Premium Unlock'
              },
              {
                display_name: 'Description',
                variable_name: 'description',
                value: 'Lifetime premium access with Sleep Tracker'
              }
            ]
          },
          onSuccess: function(transaction) {
            console.log('‚úÖ Payment successful:', transaction);
            
            showStatus(
              `‚úÖ Payment Successful!\n\nReference: ${transaction.reference}\nStatus: ${transaction.status}\n\nPremium unlocked! üéâ`,
              'success'
            );

            // Log transaction details
            console.log('Transaction details:', {
              reference: transaction.reference,
              status: transaction.status,
              message: transaction.message,
              trans: transaction.trans,
              trxref: transaction.trxref
            });

            // Re-enable button
            payButton.disabled = false;
            payButton.textContent = '‚ö° Pay ‚Ç¶8,000 with Paystack';
          },
          onClose: function() {
            console.log('üîí Payment popup closed');
            
            showStatus('‚ÑπÔ∏è Payment cancelled. You can try again anytime.', 'info');

            // Re-enable button
            payButton.disabled = false;
            payButton.textContent = '‚ö° Pay ‚Ç¶8,000 with Paystack';
          }
        });

        // Open payment popup
        handler.openIframe();
        
        console.log('‚úÖ Paystack popup opened');
        showStatus('‚úÖ Payment popup opened. Complete your payment.', 'info');

      } catch (error) {
        console.error('‚ùå Paystack error:', error);
        
        showStatus(
          `‚ùå Error: ${error.message || 'Failed to start payment. Please try again.'}`,
          'error'
        );

        // Re-enable button
        payButton.disabled = false;
        payButton.textContent = '‚ö° Pay ‚Ç¶8,000 with Paystack';
      }
    });

    // Log when script loads
    console.log('‚úÖ Paystack test page loaded');
    console.log('Public Key:', publicKey);
    console.log('Amount: ‚Ç¶8,000 (800,000 kobo)');
  </script>
</body>
</html>
